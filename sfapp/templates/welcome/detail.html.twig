{% extends 'base.html.twig' %}

{% block title %}Welcome to Smart Campus{% endblock %}

{% block head %}
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block body %}

    <!-- Contenu principal centré -->
    <div class="d-flex justify-content-center align-items-center vh-60 flex-column">
        <h1>Détails de la salle {{ room.name }}</h1>


        <div class="progress-circle-container">
            <svg class="progress-circle" viewBox="0 0 200 200">
                <!-- Cercle de bordure -->
                <circle cx="100" cy="100" r="90" class="circle-bg" />

                <!-- Vague animée -->
                <mask id="wave-mask">
                    <rect x="0" y="0" width="200" height="200" fill="white" />
                    <path class="wave" d="M 0 150 Q 50 140, 100 150 T 200 150 V 200 H 0 Z" fill="black" />
                </mask>

                <!-- Cercle avec vague -->
                <circle cx="100" cy="100" r="90" class="circle-wave" mask="url(#wave-mask)" />
            </svg>
            <div class="progress-text">{{ room.idAS.humidity }}%</div>
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const humidity = parseFloat('{{ room.idAS.humidity }}'); // Récupérer l'humidité
                const wave = document.querySelector('.wave');

                if (!isNaN(humidity)) {
                    // Calcul de la hauteur de la vague en fonction de l'humidité
                    // Humidité entre 8% (presque bas du cercle) et 90% (près du sommet)
                    let height = 200 - (humidity * 1.5); // 1.5 pour que l'humidité 90% donne presque 10

                    // Limiter la hauteur à ne pas dépasser la base (200) et à ne pas être trop basse
                    height = Math.max(10, Math.min(height, 180));

                    // Appliquer la nouvelle hauteur à la vague
                    wave.setAttribute('d', `M 0 ${height} Q 50 ${height - 10}, 100 ${height} T 200 ${height} V 200 H 0 Z`);
                }
            });
        </script>
        <h3>Température : {{ room.idAS.temperature }} °C</h3>
        <h3>Humidité : {{ room.idAS.humidity }}%</h3>
        <h3>CO2 : {{ room.idAS.CO2 }} ppm</h3>


    </div>




    <!-- Scripts JavaScript de Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
{% endblock %}